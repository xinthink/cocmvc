{"note":"Don't delete this file! It's used internally to help with page regeneration.","name":"cocmvc","tagline":"Bringing better Convention Over Configuration to Spring Web MVC","google":"UA-33049696-1","body":"# Convention Over Configuration extension to [Spring Web MVC](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html)\r\n\r\n## Why we need this extension\r\nOften, we develope web applications with the powerful Spring Web MVC in these two ways (or both of them):\r\n\r\n1. [Convention over configuration support](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-coc)\r\n  * help omitting many 'redundant' configurations\r\n  * but we must have our controllers implementing a framework specific interface, reducing the flexibility\r\n2. [Annotation-driven](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-controller)\r\n  * very powerful request mappings, and flexible handler method declarations\r\n  * but it's actual configurations, sometimes seems to be 'redundant'\r\n\r\nBoth of them are pretty good, but there's no way to put them together in a single controller, you have to make the choice, and tolerate the redundancy.\r\n\r\nBut now, with the cocmvc extension, one is allowed to write a controller like this:\r\n\r\n```java\r\n// maps to /hello\r\npublic class HelloController {\r\n  \r\n  // handling /hello\r\n  public void index(Model modle) {\r\n    modle.addAttribute(\"this's the home page of hello\");\r\n    // view-id = 'hello'\r\n  }\r\n  \r\n  // handling /hello/delete?id=1\r\n  public void delete(@RequestParam(\"id\") int id) {\r\n    ...\r\n    // view-id = 'hello/delete\r\n  }\r\n  \r\n  // handling /hello/show/1\r\n  @RequestMapping(\"show/{id}\")\r\n  public void show(@PathVariable(\"id\") int id) {\r\n    ...\r\n    // view-id = 'hello/show'\r\n  }\r\n}\r\n```\r\nWell, it combines the advantages of Spring's [COC support](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-coc) and [annotation-driven](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-controller) together, and I think it's also concise, and DRY.\r\n\r\nLet's see how to do that.\r\n\r\n## Developing by convention\r\n### URL pattern\r\nBy convention, the URL pattern is:\r\n\r\n    <context-root>/<module>/<controller>/<action>\r\n* *module*\r\n - modularity, it's a good idea to package controllers into modules in a big application\r\n - can recursively contain other sub-modules, such as: `news/sports/football`\r\n - must provide a `basePackage` to enable modularity, the relative path (to the `basePackage`) of a controller will be used as it's module; otherwise, the module part will always be empty ('')\r\n* *controller*\r\n - just like Spring or Grails, controller class named `AbcController` will be mapped to `/abc`\r\n - supports camel-case style (by default) or snake-case style, i.e. `helloWorld`, or `hello-world`\r\n* *action*\r\n - mapped to action methods (request handlers), each public method of the controller will be mapped as an `action`\r\n - method named `index` is a special case, it will be treated as the home page of the controller (the `/` action)\r\n - also by convention, `init` and `destroy` are life-cycle methods of a Spring bean, the framework will NOT treat them as actions\r\n - you can choose camel-case style (by default) or snake-case style\r\n\r\n### Controllers\r\n#### Coding a controller\r\n* Naming\r\n - Name your controller class with a 'Controller' suffix, for example: `LoginController`, `UserRegisterController`\r\n - A controller class may extends any base class or implements any interface\r\n* Packaging\r\n - You can put your controllers under any packages as you need\r\n - By setting a `basePackage`, controllers will be grouped into modules, for example, the module name of `basePackage.abc.def.HelloController` is 'abc/def', and it will be responsible to the URL `/abc/def/hello`\r\n* Write action methods\r\n - Public methods of a controller are all action methods, including methods inherited from base classes, excluding methods declared in `Object`, such as `toString`, `hashCode` ...\r\n - You can define an action method in any form supported by [Spring Web MVC](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-methods)\r\n\r\n#### Make controller a Spring bean\r\nXML configuration, component scanning ... \r\n\r\nFeel free to choose the way most fit to your project, but the component scanning way seems to be more DRY.\r\n\r\n### View templates\r\nBy convention, the view-id of each action is corresponding to the requesting URL, i.e. view-id for action `/hello/show` is 'hello/show'\r\n\r\nSo, you can ommit the view-id return value (or when instantiating the `ModelAndView`), if you comply with the conventional view templates layout\r\n\r\nFor example (assume you're using jsp):\r\n\r\n    views                                   Root of your view templates, may be /WEB-INF/views\r\n      |\r\n      |-- <controller>                      Views folder for top-level controllers\r\n      |     |-- <action>.jsp                View templates\r\n      |     \\-- ...                 \r\n      |\r\n      |-- <module>                          Views folder for module\r\n      |     |-- <sub-module>                Sub-module, recursively\r\n      |     |     |-- <controller>\r\n      |     |     |     |-- <action>.jsp    \r\n      |     |     |     \\-- ...\r\n      |     |     \\-- ...\r\n      |     |\r\n      |     |-- <controller>                Views folder for controller\r\n      |     |     |-- <action>.jsp          View templates\r\n      |     |     \\-- ...             \r\n      |     \\-- ...                  \r\n      |\r\n      |-- index.jsp                         Top-level view templates, home page, error page etc.\r\n      \\-- ...\r\n\r\n## Overrides the convention\r\nYou can override the convention by using [annotations (configurations)](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-controller).\r\n\r\nFor example, I'd like the home page located at `/`, instead of `/home`\r\n\r\n```java\r\n@RequestMapping(\"/\")\r\npublic class HomeController {\r\n\r\n  // handling /\r\n  public String index() {\r\n    ...\r\n    retrun \"index\"; // view-id = 'index'\r\n  }\r\n}\r\n```\r\n\r\nor, to use path variables\r\n\r\n```java\r\npublic class PersonController {\r\n\r\n  // handling /person/show\r\n  @RequestMapping(\"show/{id}\")\r\n  public void show(@PathVariable(\"id\") int id) {\r\n    ...\r\n    // view-id = 'person/show'\r\n  }\r\n}\r\n```\r\n\r\nand sometimes, some special public methods should not be treated as actions\r\n\r\n```java\r\npublic class PersonController {\r\n\r\n  @NoMapping\r\n  @ModelAttribute\r\n  public Person addModelAttribute() {\r\n    ...\r\n    return new Person();\r\n  }\r\n}\r\n```\r\n\r\n## Project dependencies\r\nBefore enjoy developing by convention, you should first add cocmvc to your project dependencies.\r\n\r\nAdd the following snippet in your gradle build script, or something equivalent in other dependencies management tools:\r\n\r\n    repositories {\r\n        mavenCentral()\r\n    }\r\n\r\n    dependencies {\r\n        compile 'net.sf.cocmvc:spring-cocmvc-ext:1.0'\r\n    }\r\n*please refer to the [sample build file](https://github.com/xinthink/cocmvc/blob/master/sample/build.gradle)\r\n\r\n## Configurations\r\nHuh, there's also a little configuration job to be done, in order to override the default behavior of Spring framework.\r\n\r\n```xml\r\n<!-- close spring's annotation-driven to avoid duplicated URL mapping -->\r\n<!--<mvc:annotation-driven />-->\r\n\r\n<!-- add this line to make our action methods to be adapted as request Handlers -->\r\n<bean class=\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\" />\r\n\r\n<!-- Enable conventional developing mode,\r\n  and provides a basePacakge to enabled the modularity feature\r\n-->\r\n<bean class=\"net.sf.cocmvc.ConventionalHandlerMapping\" p:basePackage=\"com.abc.controller\" />\r\n```\r\n\r\nEnjoy!\r\n\r\n#### Please refer to the [sample project](https://github.com/xinthink/cocmvc/tree/master/sample) for more details."}